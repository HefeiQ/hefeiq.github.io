Knowledge-DrivenSignalDetectorforUplink TransmissioninIoTNetworkswithUnknown ChannelModels

Abstract—In this paper, an uplink signal detection problem is considered for Internet-of-Things (IoT) networks. Owing to the imperfections of IoT devices including I/Q imbalance and amplifier non-linearity, exact end-to-end channel models and accurate channel state information (CSI) are typically unavailable at the receiver, which obstructs the application of traditional modelbased signal detection algorithms. A consensus has been reached recently that Deep learning (DL) is a promising tool to cope with this problem. However, for the IoT scenarios under consideration, devices typically transmit data using short packets with few pilot symbols, the amount of which is insufficient for each device to individually train a detector. In order to combat the data scarcity barrier and enable few-shot learning, a novel training paradigm is proposed where pilot symbols from different devices are aggregated in an intelligent manner to train a universal signal detector. Specifically, this paper devises a knowledge-driven signal detector architecture following the modular design methodology typically used in classical communication system receivers. Under this framework, three neural networks (NNs), a signal classifier, a channel feature extractor, and a signal feature extractor are created to form decision statistics and produce estimates of the transmitted symbols. Furthermore, borrowing ideas from domain adaptation, a novel component referred to as a link discriminator is integrated into the architecture to improve its generalizability. The proposed signal detector exploits pilot symbols from various IoT devices to train a universal detector that can be applied to different channel conditions without retraining, including those not seen in the training phase. Simulation results verify the superiority of the proposed knowledge-driven detector compared with existing solutions in the sense that it enjoys higher detection accuracy and can be well trained with less data. Index Terms—Signal detection, Internet-of-Things, knowledgedriven detector, few-shot learning.

WITH the development and the popularization of 5G communication systems, IoT technologies have been widely used in urban, vehicular, and industrial scenarios, etc [2]-[6]. In IoT networks, devices (e.g., distributed sensors) transmit collected data to a base station (BS), where signal detection methods are implemented to recover the transmitted information. Typically, both an exact underlying channel model and accurate CSI are necessary for the implementation of classical signal detection solutions. However, such information may be unavailable in some IoT scenarios. Owing to the imperfections or simplifications made in the transceivers’ design and manufacturing, signal transmission in IoT networks may suffer from severe non-idealities arising from phase noise [7], I/Q imbalance [8], low-resolution analogto- digital converters (ADCs) [9], and amplifier non-linearity [10]. Besides, in some scenarios like industrial applications, environmental electromagnetic impulses following unknown distributions [11] may interfere with the uplink transmissions, rendering the noise at the receiver side non-Gaussian. Due to the aforementioned reasons, it is difficult to formulate a mathematical end-to-end channel model that takes into account environmental noise, channel fading, and device non-idealities. This precludes CSI estimation and the adoption of modelbased signal detection solutions. DL is an effective tool to handle the aforementioned challenges. First, NN models can be trained as a black-box detectors using samples of the transmitted symbols and their corresponding received signals, thus making it possible to conduct signal detection without any knowledge of the channel model. Second, a signal detector is essentially a non-linear function that describes a mapping from the received signals to the transmitted message, and NNs in theory are able to approximate any complex function [12]. Third, signal detection can be viewed as a complicated classification problem, and there are a large number of classification approaches in the DL area that can be exploited. Applications of DL techniques in computer vision [13], natural language processing [14], and autonomous driving [15] have achieved remarkable success. Recently, a considerable number of researches have concentrated on the application of DL techniques in the design and optimization of wireless communication systems, ranging from physical layer issues including channel estimation, signal detection, channel decoding, and spectrum sensing [16]-[19] to networking related topics, such as resource allocation, indoor localization, and energy efficiency optimization [20]-[23]. In particular, there is an increasing interest in the DL-based signal detection under the assumption that the channel model is completely unknown. The pioneering work [24] developed several signal sequence detectors based on diverse classical NN architectures, including multi-layer perceptron [25], recurrent neural networks (RNN) [26], bidirectional RNNs (BRNN) [27], and convolutional neural networks (CNN) [28]. The work reported in [29] developed an experimental platform and created a real-world data set for molecular communications, which was utilized to train an NN and evaluate its detection performance. Experimental results show that the BRNN structure with long short-term memory (LSTM) [30] cells outperforms other candidates. Recently, we proposed to integrate a timevarying merging layer and a cooperation mechanism into the classical BRNN structure [31], which further improves the BER performance compared to prior works [24]-[30]. The major drawback of the detectors developed in [24] and [31] is that the receiver needs to implement signal detection after receiving the entire signal sequence. To decrease the latency, [32] devised a sliding bidirectional recurrent neural network (SBRNN) aimed at real-time detection, in which detection occurs immediately as each symbol arrives at the receiver. Further, based on self-attention mechanism, [33] proposed a novel real-time signal detector which enables parallelization with training data, and greatly reduces the training cost. All of the aforementioned works follow a purely data-driven philosophy where the domain knowledge of communication systems is not fully exploited. In contrast with this paradigm, [34] combined DL techniques with the BCJR algorithm to realize maximum a posteriori probability (MAP) symbol detection, where a novel NN was devised to learn the factor graph representing the finite-memory channel. Similarly, in [35], tools including a Guassian mixture model and deep feedforward NNs were adopted to learn the likelihood function of the channel, which is further utilized to implement the Viterbi algorithm. In this way, the signal detection can be realized without knowledge of the channel model. Very recently, a novel NN architecture based on generative adversarial networks (GANs) was developed to achieve a more accurate estimate of the channel likelihood function [36], which yields further improvements in detection performance. While research on DL-based signal detection with unknown channel models has realized fruitful achievements, almost all of the published in this area focuses on point-to-point links, and little work has concentrated on signal detection problem for scenarios of networked transmission (e.g. IoT). The work reported in [37] developed several uplink signal detectors for in IoT networks based on a series of meta-learning [38] approaches including model-agnostic meta-learning (MAML) [39], first order MAML (FOMAML), REPTILE [40], and context adaptation via meta-learning (CAVIA) [41]. While the detectors developed in [37] exhibit superior performance compared to traditional approaches, all of them are still purely data-driven methods and need to be trained with massive amounts of data, which is typically unavailable in IoT networks. To be more specific, according to the simulation results in [37], to achieve a symbol error rate (SER) of 10−1 at 20 dB average signal-noise-ratio (SNR), the CAVIA-based detector (the best among all meta-learning based solutions) needs to be trained with a total of 3.2 × 106 pilot symbols coming from 1000 devices. It is impractical to require such a massive training dataset in real IoT networks, where information is typically transmitted using short packets with only a few pilot symbols. Therefore, the signal detectors presented in [37] may not be well suited to detection in IoT networks. In order to deal with the problem mentioned above and enable few-shot learning, a knowledge-driven signal detector is proposed in this paper for IoT uplink transmissions with unknown channel models. Instead of simply borrowing existing NN architectures such as CNN or RNN as the building blocks to construct the detector, we design an architecture following the modular structure adopted in classical communication receivers. The proposed detector is constructed with four modules: a channel feature extractor, a signal feature extractor, a signal classifier, and a link discriminator. With the pilot symbols and their received counterparts as the inputs, the channel feature extractor obtains a channel feature vector, which is fed into the signal feature extractor, together with the received payload symbols, to remove the effect of the channel and acquire signal feature vector. In this manner, the signal feature extractor acts like a channel equalizer. Finally, based on the signal feature vector, the signal classifier estimates the transmitted symbols. As one of the key novelties of the proposed detector, the link discriminator helps the signal feature extractor learn how to perform “channel equalization” without knowledge of the channel model and the actual CSI. The introduction of the link discriminator enhances the generalizability of the knowledge-driven detector, and enables it to be applied to be applicable to new channel conditions without retraining. We also propose a novel NN implementation structure in which the channel feature extractor is implemented as the weight generator for the signal feature extractor to mirror the equalization process followed in standard communication receivers. We have found that this further improves the accuracy of the detector. It can be seen from the discussion above that the signal detector presented in this work is guided by domain knowledge from communications systems design. Hence we refer to our resulting algorithm as a knowledgedriven approach.
We emphasize that the proposed knowledge-driven approach is different from the well-known data-driven and model-driven alternatives. For DL-based data-driven methods, the detector is constructed as a black-box using standard NN structures, and a large amount of data is used for brute-force training. In model-driven DL-based solutions, NNs are integrated using domain knowledge in the form of models and algorithms [42]. Typically, in these approaches NNs are constructed by unfolding an iterative algorithm into a signal flow graph or exploited to replace some modules in the signal detectors. In contrast, the knowledge-driven approach proposed here follows the philosophy of designing a targeted neural network for the signal detector that derives its architecture from that used in classical communication systems. The primary contributions of our work are summarized as follows: 
• First, a novel receiver architecture based on DL is designed for the signal detection problem in IoT networks with unknown channel models. The receiver design is inspired by domain knowledge in communications theory, and follows the modular structure of classical communication system receivers.  
• Second, to improve the generalizability of the proposed detector, a novel module referred to as the link discriminator is developed to help the receiver learn how to perform channel estimation without using labeled data. This enables the detector to be applicable to various channel conditions.
• Third, a novel NN architecture is proposed in which the channel feature extractor is used to generate the parameters for the signal feature extractor. This approach achieves better channel equalization performance and further improvements in detection accuracy.
• Fourth, a unique adversarial learning method is presented based on the idea of domain adaptation. With the proposed learning algorithm, pilot symbols from various IoT devices are aggregated to train the NN model. After training, the detector is able to adapt to new channel conditions without retraining. 
The remainder of this paper is organized as follows. The problem statement is presented in Section II. Section III introduces the architecture of the knowledge-driven signal detector. Section IV describes the NN implementation of the proposed detector as well as the learning algorithm. Section V presents simulation results including performance comparisons between the proposed approach and various existing solutions. Finally, conclusions are provided in Section VI. Throughout this paper, CN(μ, σ2) stands for the complex Gaussian distribution with mean μ and variance σ2, B(n, p) represents the Bernoulli distribution where the success probability is p and the number of trials is n, and U(a, b) denotes the uniform distribution over the interval [a, b].
II. PROBLEM STATEMENT
As presented in Fig. 1, we consider an uplink signal detection problem for an IoT network that consists of a BS and K low-cost devices. We assume the different IoT devices experience independent and identically distributed channel conditions and adopt the same modulation scheme during the uplink transmission. We also assume that only one IoT device is allowed to transmit data within a given resource block, which implies that the BS does not need to deal with inter-user interference. This assumption is easily satisfied using scheduling algorithms. For example, in sensor networks deployed for environmental monitoring, data packets are usually uploaded in a deterministic and periodic manner [43], which makes it possible to assign sensor transmissions to pre-allocated time slots. It should be noted that this assumption is also made in the prior work [37], which serves as a benchmark for our approach. The input-output relationship for the k-th device’s transmission can be formulated as (1 ≤ k ≤ K) yk = fk(sk) + zk, (1) where sk is the source symbol transmitted from device k, zk is receiver noise, and yk is the received signal at the BS. The effect of the end-to-end channel from device k to the BS is represented by fk(·). Due to the non-idealities of IoT devices resulting from phase noise, I/Q imbalance, lowresolution ADCs, and amplifier non-linearity, fk(·), which not only describes the effect of the over-the-air channel but also accounts for the characteristics of the IoT devices, is typically a non-linear function. Also, unlike the commonly-adopted Gaussian assumption for receiver noise, zk may follow a non- Gaussian distribution (for example, in industrial environments, the transmitted symbols may experience impulsive interference [44]). Moreover, exact models for the receiver noise and transceiver imperfections are typically unavailable in practice, which precludes the possibility of using classical model-based signal detection methods.
We propose to employ DL techniques to deal with the aforementioned problem. In one possible approach, an NN can be deployed at the BS to realize DL-based signal detection. The BS would need to collect pilot symbols and their associated received signals as the dataset to train the NN. However, in order to achieve satisfactory performance with such an implementation, the NN training process of neural networks requires a large amount of data, which conflicts with the pilotless property of IoT networks [45]. A natural approach to solve this problem is to aggregate pilot data from all IoT devices and jointly use them to train one signal detector which would then be applied to all IoT devices. However, a naive approach to aggregating the data can actually lead to a significant performance degradation. As a simple example, assume there are two IoT devices D1 and D2 employing quadrature phase shift keying (QPSK) modulation. The received signal constellations at the BS from D1 and D2 are shown in Fig.2-(a) and Fig.2-(b), respectively, along with the decision boundaries. It is evident that the signal detectors for D1 and D2 are different, due to the difference in the channels experienced by the two devices. Clearly, a naive averaging of the two detectors without prior channel equalization would lead to poor performance for both D1 and D2.

Fig. 1: IoT Scenario

Fig. 2: The received signal constellations at BS from two different IoT devices.

Fig. 3: Standard modular structure for communication system receivers.

From the toy example presented above it can be seen that to deal with the shortage of training data, we need to aggregate pilot-received signal pairs from various IoT devices (referred to hereafter as training devices) using a more intelligent paradigm such that the trained detector can be utilized to realize signal detection for any new device (referred to below as a testing device) which may experience an independent uplink channel that is entirely different from those experienced by the training devices. In the next section, we show how our knowledge-driven approach can provide a novel solution to this problem. III. KNOWLEDGE-DRIVEN SIGNAL DETECTOR DESIGN We assume that the transmitted and received pilots from M IoT devices D1,D2, ...,DM have been collected at the BS. The question is, with these training data available, can we design a universal signal detector that performs well for all IoT devices in the network each experiencing an independent and unknown end-to-end channel?
We seek the answer to this question from classical communication theory. Fig. 3 describes a standard modular receiver architecture that is widely used in modern communication systems. The pilot part of the received signal is used as input to the channel estimation module to obtain ˆH, an estimate of the channel coefficient matrix H. Based on ˆH, a channel equalizer H+ is multiplied by the received signal y to produce1 ˜y = H+y = x + H+n, (2) which is fed to the succeeding signal detection module as the decision statistic used to generate the estimate of the transmitted symbol. Since the channel equalization operation has eliminated the channel-associated information in y, ˜y is independent of underlying channel2. Therefore, the signal detector in the classical approach is independent of the CSI and is thus a universal detector. Consequently, only the modulation type needs to be taken into consideration for the detector design.
It is obvious that the aforementioned receiver structure can work well for most channel conditions. However, the lack of channel information prohibits the application of this classical receiver structure in the considered IoT scenario. Having said that, this modular receiver structure offers useful insights for receiver design in communication systems with unknown channel models. Motivated by the classical design in Fig.3, we construct a DL-based receiver composed of several NNs as building blocks, given in Fig.4. The transmitted pilot symbols and the corresponding received signals are passed through a Channel Feature Extractor (CFE), which mirrors the operation of channel estimation in standard communication systems. Then the received data sequence together with the channel feature vector is fed to a Signal Feature Extractor (SFE), which behaves functionally like a channel equalizer, to produce a signal feature vector. Ideally, in this step, the SFE has removed the channel-related information, and makes the signal feature vector independent of underlying channel. Finally, a Signal Classifier (SC), which acts like a signal detector, accepts the signal feature vector as the input and outputs the estimate of the transmitted symbol.
The DL-based detector described above incorporates all of the components in a classical receiver structure, and these components are implemented with neural networks.With training data collected from various training devices, all receiver modules (CFE, SFE, and SC) are jointly trained. The following description summarizes the advantages of the developed structure. First, since the classical receiver in Fig. 3 is universal, the DL-based counterpart in Fig. 4 is also expected to be a general signal detector that is applicable to various channel conditions. This implies that training data from different devices can be used together to train the proposed NN structure as a universal detector. In this manner, the training data can be utilized in a more efficient way compared with training detectors for each device individually. Second, unlike popular practice in which existing NNs such as CNN or RNN are simply combined together to build a black-box detector, the design presented in Fig. 4 is motivated by communications theory and is essentially an AI implementation of the classical modular receiver in Fig. 3. This enhances the possibility that the behavior of the developed detector architecture can be explained.
However, it is experimentally found that when the number of training devices is not sufficiently large, the performance of this detector is not satisfactory if it is employed to implement signal detection for a new device whose channel condition is different from that of the training devices. This implies that the basic DL-based detector in Fig.4 lacks generalizability. The main reason for this deficiency can be briefly explained as follows. In the receiver structure shown in Fig.4, due to ignorance of the true value of H, it is relatively difficult to train the CFE, whose output may not accurately represent the real CSI. Consequently, with limited training devices, the channel-associated information in the received signal cannot be completely removed by the SFE, which means that the signal feature vector is still CSI-dependent. Under this circumstance, the symbol detection error rate can still be kept at a very low level on the training dataset, because the SC is trained to learn how to detect symbols based on a received signal that is not well equalized. However, a CSI-dependent signal feature vector makes the SC (i.e., the signal detection rule) CSIdependent as well. Therefore, when the trained signal detector is deployed for a new device which experiences an underlying channel independent of the training devices, it fails to meet the design goal and suffers from performance degradation.

Fig. 4: Basic DL-based receiver architecture.

Fig. 5: Modified DL-based receiver architecture.

In order to improve the generalizability, the basic detector in Fig.4 is improved to yield the enhanced version shown in Fig.5. The only difference between Fig.5 and Fig.4 is that a new module labeled as the Link Discriminator (LD) is now introduced. With the signal feature vector as its input, the LD estimates the index of the link (channel) where the received signal comes from. Although the actual channel response function of each device is unknown, the link index for each received signal is known by the BS. During the training process, the SC and the LD are trained to minimize their error rates, while the CFE and the SFE are trained using an adversarial approach in which the error rate of the SC is minimized and that of the LD is maximized. The overall network is jointly trained, and after convergence, we expect that the detection accuracy of the SC is sufficiently high while the error rate of the LD approaches 1 − 1 M (equivalent to a random guess). If this goal can be realized, it implies that: (1) the information required for signal detection is included in the signal feature vector; (2) the channel-related information has been eliminated from the received signal such that the link index cannot be inferred based on the signal feature vector. The second observation further suggests that the CFE has successfully performed channel estimation, and the obtained channel feature vector will be well matched to the actual channel condition. Intuitively, the introduction of the LD helps the CFE learn how to do channel estimation without using labeled data (i.e., the ground truth for H), thus decreasing the risk of over-fitting when the number of training devices is not sufficiently large.
We emphasize that the LD appears only during the training phase. During the testing phase, the LD is not used at all, which suggests that the link index for the received signal is not required to be known when the detector is in use. This can be seen more clearly at the end of Sect. IV. B. The training and testing process of the proposed DL-based detector is illustrated in Fig. 6. During the training phase, pilotreceived symbol pairs from M training devices are utilized to train the knowledge-driven detector. During the testing phase, The trained NN is deployed to perform signal detection for the testing devices, each of which experiences an independent uplink channel from that of the training devices. The pilotreceived symbol pairs along with the received payload symbols are fed into the knowledge-driven signal detector, which outputs the estimate of the transmitted payload symbols. IV. NEURAL NETWORK IMPLEMENTATION AND LEARNING ALGORITHM
A. NN Implementation of the Proposed Signal Detector 
As exhibited in Fig. 7, the NN implementation of the proposed knowledge-driven detector is composed of four modules3. Here, the signal classification network and the link discrimination network correspond to the SC and the LD in Fig.5, respectively. The feature extraction network is an embodiment of the SFE, which accepts the received signal as input and outputs the signal feature vector. Like other modules, the feature extraction network is also implemented using NNs, but the weights (i.e., NN parameters) of this module are not trainable. Instead, all weight parameters of the feature extraction network (denoted by θf ) are provided by the output of a weight generation network shown on the bottom left of Fig. 7, which corresponds to the CFE in Fig. 5. The inputs to the weight generation network include the transmitted and received pilot data publicly known by both the transmitter and the receiver. After reshaping, the output of the weight generation network will be used as the NN parameters for all layers of the feature extraction network. Intuitively, the weight generation network learns how to perform channel estimation from the training data, and the feature extraction network executes channel equalization based on the learned channel features θf . We observe from Figs. 5 and 7 that the CFE and SFE are not directly implemented with two NNs. Instead, they are realized with a trainable NN (i.e., weight generation network) and a non-trainable module (i.e., feature extraction network), respectively. The reasons for this are summarized next.

Fig. 6: Illustration of the training and the testing process.

Fig. 7: NN implementation of the proposed knowledge-driven signal detector.

As illustrated in Fig. 5, the CFE is used to realize channel estimation, which is implemented by the weight generation network in Fig. 7. This implies that the output of the weight generation network represents the channel features. In classical communication theory, the channel equalization is realized via multiplication between the pseudo-inverse of the estimated channel H+ and the received signal vector y (please refer to (2))4. If the SFE is implemented by a trainable NN, the channel features together with the received signal will be fed into the SFE, and how they are processed is determined by the structure and parameters of the NN. Since the operation of an NN is rather dissimilar to that of the classical multiplicative equalizer, the NN representing the SFE does not realize channel equalization in the standard way. The above observations motivate us to use the output of the weight generation network (i.e., channel features) as the parameters of the feature extraction network. According to the basic operating rules of NNs [46], the channel features (i.e., parameters of the feature extraction network) will be multiplied by the received signal (i.e., input of the feature extraction network) to yield the output. In this manner, the feature extraction network operates in accordance with standard methods for channel equalization, thus removing the channel-dependent information from the received signal as expected5. Our empirical studies have shown that this communication-system-oriented architecture provides a considerable performance improvement compared with the use of two independent trainable NNs.
B. Learning Algorithm
The training of the proposed signal detector is realized offline. Before the training procedure starts, with M training devices available, the BS collects Ntr pairs of pilot-received signals from each training device to obtain the training set D = {Dk}k=1,2...,M , where Dk = {(s(n) k , y(n) k ) : n = 1, ...,Ntr} and the pilot-received signal pair (s(n) k , y(n) k ) is the n-th data sample for training device k. The learning algorithm is illustrated below.
Step 1: All NN model parameters are initialized randomly. The parameters of the weight generation network, the signal classification network, and the link discrimination network are denoted as θw, θy, and θd, respectively.
Step 2: Randomly sample a batch of training devices, and denote the indices of the chosen devices as k1, k2, ..., km. Hereafter, we use B ≜ {k1, k2, ..., km} to represent the set of chosen devices. Implement Step 3∼Step 5 repeatedly for each ki ∈ B:
Step 3: A set of training data is sampled from Dki , and this set is divided into two subsets: the support set and the query set. We denote the cardinality of support and query sets as Ns and Nq, respectively.
Step 4: The weight generation network accepts the support set as the input, and produces Ns channel feature vectors, which are averaged to obtain θif , the NN parameters of the feature extraction network. The superscript i indicates that θif is specific to the i-th device in B.
Step 5: For notational simplicity, we denote the pilot signal s(n) ki and its received counterpart y(n) ki in the query set as sj and yj , respectively, where j = 1, 2, ...,Nq. The training samples in the query set are fed into the feature extraction network, then the signal classification network and the link discrimination network output Gy(·; θy) and Gd(·; θd), respectively, which are utilized to obtain the corresponding loss functions Li y and Li d. The superscript i represents that the loss functions are calculated at the i-th device in B. Note that both the signal classification and the link discrimination networks are essentially classifiers. Therefore, the cross-entropy, represented by L(·, ·), is adopted here as the loss function to compute the distance between the data label and the output of NN, and Li y and Li d are thus calculated as Li y = ΣNq j=1 L(Gy(Gf (yj ; θif ); θy), sj), (3) Li d = ΣNq j=1 L(Gd(Gf (yj ; θif ), sj ; θd), ki). (4) The description in Sect.III suggests that the parameters of the weight generation network θw should be updated such that the loss function of the signal classification network is minimized (i.e., the signal detection accuracy is maximized) and that of the link discrimination network is maximized (i.e., the link discriminator is unable to determine the index of the link according to the signal feature vector). This can be realized by defining the loss function of the weight generation network as Li w = Li y − λLi d, (5) with the balancing factor λ > 0. Note that although θw is not explicitly present in (5), the loss is still a function of θw since θif is determined by θw.
Step 6: The total loss functions of the entire batch B for the signal classification, link discrimination and weight generation networks are respectively obtained as Ly = mΣ i=1 Li y, Ld = mΣ i=1 Li d, Lw = mΣ i=1 Li w.
Step 7: Following the domain adaptation approach developed in [47], the NN parameters are updated to minimize the respective loss functions as follows: θy ← θy − μ ∂Ly ∂θy , (6) θd ← θd − μ ∂Ld ∂θd , (7) θw ← θw − μ( ∂Ly ∂θw − λ ∂Ld ∂θw ), (8)
where μ is the learning rate. The updates in (6)∼(8) are very similar to the conventional stochastic gradient descent (SGD) method. The only difference is the −λ factor in (8), which is crucial for ensuring that the extracted signal feature vector no longer contains channel-related information, and hence that the link discriminator is unable to determine the identity of the device. In order to achieve such an effect, a gradient reversal module is inserted between the weight generation network and the link discrimination network, as shown in6 Fig.7. As the back propagation process passes through the gradient reversal module, ∂Li d ∂θw is replaced by −λ∂Li d ∂θw . This ensures that θw is updated to minimize the loss function of the signal classification and maximize that of the link discrimination in the same time.
Step 8: Repeat Step 2∼Step 7 until the loss function converges. After the training phase, the obtained signal detector implements signal detection for the testing devices. In the testing phase, the link discrimination network is no longer used. The transmitted and received pilot data are first fed into the weight generation network to compute the NN parameters θf specific to the testing device, while the NN parameters of the signal classification network remain unchanged. Then, the received information-bearing signal is passed through the feature extraction and signal classification networks to estimate the transmitted signal.
V. SIMULATION RESULTS AND DISCUSSIONS
A. Simulation Setups
In our simulations, all IoT devices adopt 16-QAM modulation, and we consider two non-linear effects to model the imperfections at the transmitter side as shown in Fig. 8: 
1) I/Q Imbalance. We use the following model to describe the effect of I/Q imbalance [8]: xk = (1 + ϵk) cos δkℜ{sk} − (1 + ϵk) sin δkℑ{sk} + j((1 − ϵk) cos δkℑ{sk} − (1 − ϵk) sin δkℜ{sk}). (9) In (9), the random variables ϵk and δk represent the phase and amplitude imbalance factors, respectively. In this work, we assume ϵk = 0.15ϵ′ k and δk = 15δ′ k, where both ϵ′ k and δ′ k follow a (5, 2) beta distribution. 
2) Non-linear Amplifier. To account for the non-linear distortion introduced by most practical amplifiers, we use the
following model [48]: xk = A(|sk|) exp{jΦ(|sk|)}sk |sk| . (10) In (10), A(r) = vr 1+βar2 and Φ(r) = αϕr2 1+βϕr2 , where βa ∼ U (0.05, 0.1), βϕ ∼ U (0.15, 0.25), v = 3, and αϕ = π/12. The uplink wireless channel for device k is yk = hkxk + nk, (11) where hk ∼ CN ( 0, σ2h ) is the channel coefficient. In our simulations we set σ2h = 1. Instead of modeling nk as additive white Gaussian noise (AWGN) as in most work, we model it as nk = wk + ik, (12) where the thermal noise wk is a complex Gaussian random variable with mean zero and variance σ2 2 . Following [49], the impulse noise ik is a Bernoulli-Gaussian process, which is the product of a complex Gaussian process and a real Bernoulli process: ik = gkbk, (13) where gk ∼ CN ( 0, 5σ2 ) and bk ∼ B (1, 0.1) are independent random variables. It is easy to show that, with the above settings, the total variance of the noise nk is σ2. In the subsequent simulations, the channels from the M training devices to the BS are generated to be independent and identically distributed (i.i.d.). And each training device collects 64 pilot-received signal pairs, implying that the total amount of training data is 64×M samples. During the training procedure, the batch size is set as 64, i.e., 4 devices with 16 pilot-received signal pairs for each device. For each device, the 16 pilot-received signal pairs are divided into a support set with 4 pairs and a query set with 12 pairs. The balancing factor λ is set as 1, and the learning rate is given by μ = 0.0002. Having completed the training phase, the obtained detector is applied to perform signal detection for the testing devices. The channels from the testing devices to the BS are independent of the “training-device-to-BS” channels. During the testing phase, an N-shot learning strategy is adopted. This means that the testing device first transmits N pilot symbols to the BS, and then the received pilot signals are used to generate the NN parameters θf of the feature extraction network. After that, the received payload data is fed into the signal detector to obtain the decision results. Notice that N is much smaller than 64, thus the overhead of the testing phase is limited. We implement all NNs with fully connected architectures. The NN structure of the four proposed detector modules are displayed in Fig. 9. The average SER is adopted as the metric for performance evaluation, which is the average symbol error rate of 104 testing devices with 2048 symbols from each device. Four competing signal detection methods are chosen for performance comparison, which are introduced as follows:
1) MMSE+ML: This is a classical method that dose not use DL techniques. In this approach, the linear minimum mean square error (MMSE) approach is applied to implement channel estimation, without considering the channel nonlinearity. Then the BS uses the maximum likelihood (ML) criterion to estimate the transmitted symbols.
2) Joint Training: In this approach, a single fully-connected NN is deployed at the BS as the signal detector (i.e., classifier), which is trained using pilot-received signal pairs from all training devices.
3) Meta Learning via MAML: This approach was developed recently in [37]. Like the Joint Training method, a fullyconnected NN is also deployed as the signal detector. However, the training approach is different. The key idea of MAML is to identify an initial set of NN parameters θ by utilizing the pilot-received signal pairs from the training devices. For any testing device, the parameter adjustment produces an updated parameter ϕ that yields a low value of the loss function with only a limited number of SGD updates starting from θ. For more details, please refer to [37].
4) Meta Learning via CAVIA: This approach was also proposed in [37], where a fully-connected NN is employed as the signal detector. During the training phase, CAVIA adopts a context variable as an additional input to the detector, and uses samples from the training devices to obtain the NN parameters. During the testing procedure, the NN parameters are fixed, and the context parameter is updated using the SGD algorithm with pilot-received signal pairs from the testing devices to realize adaptation. All of the aforementioned DL-based detectors are trained using a Ubuntu server with a NVIDIA GeForce RTX 2080 Ti GPU. Table I summarizes the computation time consumed in training these detectors. The total training time is the product of the training time for one epoch and the number of epochs, which is the number of epochs required for the training to converge. The results in Table I suggest that the overall training time of the proposed detector is much less than that of two meta-learning-based approaches. While the training overhead of the Joint Training alternative is lower than others, its achievable SER performance is rather poor, as will be shown shortly.

Fig. 8: Constellations of xk due to two possible non-linear effects.

TABLE I: Training Time Comparison
Method | Training Time for One Epoch (Sec.)| Number of Epochs | Total Training Time (Sec.)
Joint Training | 0.6326 | 1500 | 948.9
MAML | 2.7836 | 2000 | 5567.2
CAVIA | 2.1330 | 1500 | 3199.5
Proposed Detector | 1.3844 | 1500 | 2076.6

B. Simulation Results
We conduct several numerical simulations to evaluate the performance of the proposed method. Fig. 10 presents the SER results of the case that the channel non-linearity is due to I/Q imbalance. In Fig. 10, the number of training devices M is 100 during the training stage, and a 4-shot learning strategy is used in the testing stage (i.e., 4 pilotreceived symbol pairs are used to update the NN parameters for each testing device). It can be observed from Fig. 10 that the SER performance of the joint training method is roughly the same as that of random guessing. This phenomenon is as expected since the channel from the testing device to the BS is independent of that from the training device to the BS. The traditional method “MMSE+ML” also behaves poorly since the non-linear property of the end-to-end channel is not captured. Although a significant performance gain is achieved by meta-learning approaches such as MAML or CAVIA, their SER performance is still close to that of the traditional “MMSE+ML” solution due to the limited amount of data available for online adjustment. In this simulation, only 4 pilot-received symbol pairs are utilized for the finetuning process of the various methods, which is insufficient for the meta-learning NNs to adapt to the testing device. By designing the NN architecture according to domain knowledge from classical communications theory, the proposed solution is able to perform channel estimation, equalization, and signal detection in a manner similar to the traditional receiver, even though the models for the noise and the underlying channel are completely unknown. This explains the fact that the proposed DL-based receiver shows superior performance for the entire SNR range compared with all the other alternatives. Fig. 11 illustrates how the proposed signal detection method works for the system operating with non-linear amplifiers. The simulation settings in this figure are identical to those adopted in Fig. 10 except that the I/Q imbalance is replaced by the power amplifier non-linearity. The results obtained in this case are similar to those in Fig. 10, fully exhibiting the superiority of the knowledge-driven detector design compared with both the traditional solution and meta-learning methods. In a later simulation we will show that the performance advantage of our proposed approach is maintained as well for larger numbers of pilots for each testing device.

Fig. 9: NN structures and parameters of four modules of the proposed detector.

Fig. 10: SER simulation results with I/Q imbalance where M = 100 and N = 4.

Fig. 12: SER simulation results over a fading channel with Gaussian noise and non-linear amplification, where M = 100 and N = 4.

Fig. 11: SER simulation results for non-linear amplification with M = 100 and N = 4.

Fig. 13: SER versus the number of training devices M with I/Q imbalance, average SNR of 30dB and N = 4.

While impulsive noise models were used in generating the results of Figs. 10 and 11, we emphasize that the knowledgedriven detector is applicable to other noise models as well. For example, in Fig. 12, we plot the SER for a fading channel with Gaussian noise where the other simulation settings are identical to those in Fig. 11. Similar observations can be obtained from this figure compared to Figs. 9 and 10, indicating the universality of our design. In the simulations shown in Figs. 10-12, the number of training devices is fixed as 100. In order to study the effect of training overhead on the SER performance of the various methods, the results of several simulations where the number of training devices varies are given in Figs. 13-14, where the effect of the I/Q imbalance and non-linear amplifiers are considered, respectively. The SER result of the basic DL-based receiver (described in Fig. 4) is also presented in Fig. 13. It is observed that the proposed knowledge-driven detector achieves a lower SER compared with the traditional “MMSE+ML” method even if the number of training devices is quite limited (e.g., M = 20). Also, the knowledge-driven signal detector significantly outperforms the basic DL-based detector whenM is less than 80, which confirms our claim in Sect. III that the performance of the basic DL-based receiver is unsatisfactory when the number of training devices is not sufficiently large. The performance gap between the modified architecture and the basic structure demonstrates that the introduction of the link discriminator assists the channel feature extractor in learning how to perform channel estimation, thus relieving the dependence of the DL approach on a large volume of training data. Finally, when M decreases, the meta-learning based solutions are even outperformed by the model-driven method “MMSE+ML”. This demonstrates that the performance of meta-learning approaches heavily relies on the amount of training data owing to their fully data-driven characteristic. The impact on the SER of the number of pilots for each testing device is investigated in Fig. 15 and Fig. 16. In these two simulations, the I/Q imbalance and amplifier nonlinearities are included to model the imperfections at the transmitter, respectively, and the number of training devices M is set as 60. In Fig. 15, it is observed that all the SER curves show a non-ascending trend as N increases. Intuitively, with more pilot symbols, the receiver is capable of estimating CSI more accurately, which helps to improve the detection accuracy. It can also be seen that for all values of N, the performance of the knowledge-driven signal detector significantly surpasses all other approaches. Moreover, the performance of the proposed detector with only 1 pilot is comparable to that of the meta-learning based detector with 32 pilots. This demonstrates that the proposed signal detector is capable of estimating CSI accurately with very limited pilots thanks to the combination of classical communications theory and DL techniques, which enable the proposed detector to adapt to new channel conditions with much less overhead compared with the purely data-driven solutions. Similar observations can be made from Fig. 16 as well. The only difference is that the SER of the traditional method “MMSE+ML” remains almost unchanged when N is larger than 4. This stems from the fact that the system with non-linear amplifiers suffers from a more severe distortion compared to that of the I/Q imbalance (see Fig. 8), which cannot be compensated for by increasing N.  Fig. 14: SER versus the number of training devices M with nonlinear amplification, average SNR of 20 dB and N = 4

Fig. 16: SER versus the number of pilots N for each testing device with non-linear amplification, average SNR of 20 dB and M = 60.

Fig. 15: SER versus the number of pilots N for each testing device with I/Q imbalance, average SNR of 30 dB and M = 60.

Fig. 17: SER versus the variance of channel coefficients in the testing phase with an average SNR of 20 dB, M = 100, and N = 4.

In the numerical simulations presented above, the channels of the training and testing devices are i.i.d.. To examine the robustness of the various detectors, in Fig. 17 we consider a situation where the statistical characteristics of the channels experienced by the testing devices are different from those for the training devices. We assume the amplifier non-linearity is present and evaluate the SER performance of all candidate solutions when trained with a fixed channel distribution (h ∼ CN(0, 1)) and tested with various channel distributions (h ∼ CN(0, σ2h ), σ2h ∈ {1, 1.5, 2, 2.5, 3}). Fig. 17 shows that the performance gap between the knowledge-driven detector and the meta-learning based solutions grows with an increase in σ2h , which indicates that the proposed structure is more robust to variations in the channel statistics compared with the meta-learning based approaches. The intuition behind this phenomenon is that the link discriminator can help the receiver learn how to remove channel-related information from the received signal, which ensures the applicability of the detector to various channel conditions and enhances its generalizability. Since the meta-learning detectors are constructed without exploiting domain knowledge, they lack this ability and thus their performance is highly dependent on distribution consistency between the training and testing sets.
VI. CONCLUSIONS
In this article, we developed a knowledge-driven signal detector for uplink transmission in IoT networks with unknown channel models. We also devised a novel NN implementation method for the proposed detector architecture, and a training algorithm based on domain adaptation. The proposed signal detector design follows the modular structure of classical receivers, and guarantees that the detector is universal and is able to implement signal detection for various channel conditions without retraining. Numerical simulations were performed to evaluate the SER performance of the proposed detector as well as the traditional “MMSE+ML” approach and meta-learning based solutions. The results of these simulations demonstrate the superior performance of the proposed knowledge-based detector.
